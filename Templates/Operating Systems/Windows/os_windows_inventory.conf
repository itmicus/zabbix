# This is a configuration file for Template Windows OS itmicus.ru
############ GENERAL PARAMETERS #################
UserParameter=custom.os.powershell.version,powershell -NoProfile -ExecutionPolicy Bypass -Command "& {if (test-path variable:psversiontable) {$psversiontable.psversion.Major} else {([version]'1.0.0.0').Major}}"
UserParameter=custom.os.updates.latestupdatesinstalled,powershell -NoProfile -ExecutionPolicy Bypass -Command "& {$update_latest_date =  (Get-WmiObject win32_quickfixengineering |sort installedon -desc  |Select-Object -First 1 ).InstalledOn;$diff= (GET-DATE) - $update_latest_date;$update_latest_seconds = [math]::Round(($diff).TotalSeconds);$update_latest_seconds}"
UserParameter=custom.os.pendingreboot,powershell -NoProfile -ExecutionPolicy Bypass -Command "& {if (Get-ChildItem 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Component Based Servicing\RebootPending' -EA Ignore) { return 1 };if (Get-Item 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired' -EA Ignore) { return 1 };return 0;}"
UserParameter=custom.os.powershell.remoting,powershell -NoProfile -ExecutionPolicy Bypass -Command "& {[int][bool](Test-WSMan -ComputerName $env:COMPUTERNAME -ErrorAction SilentlyContinue)}"