<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2020-09-27T17:44:38Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template OS Windows Active</template>
            <name>Template OS Windows Active (itmicus.ru)</name>
            <description>Template OS Windows Active (itmicus) Version: 1.1&#13;
&#13;
Template for monitoring OS Windows: Clients (7/8/10) and Servers (2008/2012/2016)&#13;
&#13;
CPU&#13;
Memory&#13;
Physical and logical Disk&#13;
Network&#13;
Inventory&#13;
Windows Updates&#13;
Firewall status</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>Filesystems</name>
                </application>
                <application>
                    <name>Hardware overview</name>
                </application>
                <application>
                    <name>Inventory: Hardware</name>
                </application>
                <application>
                    <name>Inventory: OS</name>
                </application>
                <application>
                    <name>Inventory: Software</name>
                </application>
                <application>
                    <name>Network</name>
                </application>
                <application>
                    <name>OS</name>
                </application>
                <application>
                    <name>OS overview</name>
                </application>
                <application>
                    <name>Performance</name>
                </application>
                <application>
                    <name>Physical memory</name>
                </application>
                <application>
                    <name>Services</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Version of zabbix_agent(d) running</name>
                    <key>agent.version</key>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>Template OS Windows Active (itmicus.ru)</name>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Data inventory</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>os.windows.active[get,inventory]</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Antivirus</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.antivirus</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Antivirus: name, version,last update</description>
                    <applications>
                        <application>
                            <name>Inventory: Software</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.Antivirus</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Bios version</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.biosversion</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>BiosVersion</description>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.BiosVersion</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Chassis</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.chassis</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>CHASSIS</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.Chassis</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Computer architecture</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.computerarchitecture</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>HW_ARCH</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ComputerArchitecture</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Computer Manufacturer</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.computermanufacturer</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>ComputerManufacturer</description>
                    <inventory_link>VENDOR</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ComputerManufacturer</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Computer model</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.computermodel</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>MODEL</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ComputerModel</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Computer number of logical processors</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.computernumberoflogicalprocessors</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>1w</trends>
                    <description>ComputerNumberOfLogicalProcessors</description>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ComputerNumberOfLogicalProcessors</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Computer number of processors</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.computernumberofprocessors</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>1w</trends>
                    <description>ComputerNumberOfProcessors</description>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ComputerNumberOfProcessors</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>CPU model</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.cpumodel</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>CPU model</description>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CPUModel</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Domain</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.domain</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Domain or workgroup name</description>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.Domain</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Firewall status</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.firewallstatus</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>FirewallStatus</description>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.FirewallStatus</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>Firewall status has just been changed</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Hostname</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.hostname</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.Hostname</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Motherboard manufacturer</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.motherboadrmanufacturer</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.MotherboardManufacturer</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Motherboard product</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.motherboardproduct</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.MotherboardProduct</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Networks</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.networks</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>HOST_NETWORKS</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.Networks</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Operating System build version</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.osbuildversion</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OSBuildversion</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Operating System days from latest update installed</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.OSDaysFromLatestUpdatesInstalled</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OSSecondsFromLatestUpdatesInstalled</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;{$WINDOWS_UPDATE_LAST_INSTALL_INFO} and {last()}&lt;{$WINDOWS_UPDATE_LAST_INSTALL_WARN}</expression>
                            <name>Windows updates installed more than 90 days ago</name>
                            <priority>INFO</priority>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;{$WINDOWS_UPDATE_LAST_INSTALL_WARN}</expression>
                            <name>Windows updates installed more than 180 days ago</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Operating System installation date</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.osinstalldate</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OSInstallDate</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Operating System latest update installed</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.OSLatestUpdatesInstalled</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OSLatestUpdatesInstalled</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Operating System title</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.ostitle</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>OS</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OSTitle</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Operating System uptime</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.osuptime</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <units>s</units>
                    <description>OSUptime</description>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OSUptime</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Operating System vendor</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.osvendor</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OSVendor</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Operating System version</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.osversion</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OSVersion</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Operating System Pending Reboot</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.PendingReboot</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <description>OS Pending Reboot, after install updates</description>
                    <applications>
                        <application>
                            <name>Inventory: OS</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Microsoft Windows Pending Reboot</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.PendingReboot</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{last()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}=0</recovery_expression>
                            <name>Operation System pending reboot</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>PowerShell Remoting is Active</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.powershellremoting</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <description>PowerShell Remoting is Active</description>
                    <applications>
                        <application>
                            <name>Inventory: Software</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ShellVersion.PSRemotingActive</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>PowerShell version</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.powershellversion</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>SOFTWARE_APP_A</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: Software</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ShellVersion.PowerShell</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Serial number</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.serialnumber</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>TAG</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.SerialNumber</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>SM BIOS Version</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.SMBIOSBIOSVersion</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.SMBIOSBIOSVersion</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Total physical memory</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.totalphysicalmemory</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <units>B</units>
                    <description>TotalPhysicalMemory</description>
                    <applications>
                        <application>
                            <name>Inventory: Hardware</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.TotalPhysicalMemory</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Zabbix agent version</name>
                    <type>DEPENDENT</type>
                    <key>os.windows.inventory.zabbixagentversion</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>SOFTWARE_APP_B</inventory_link>
                    <applications>
                        <application>
                            <name>Inventory: Software</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ZabbixAgentVersion</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>os.windows.active[get,inventory]</key>
                    </master_item>
                </item>
                <item>
                    <name>Number of processes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>proc.num[]</key>
                    <history>1w</history>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Physical memory swap space free</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.swap.size[,free]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Physical memory swap space total</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.swap.size[,total]</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System information</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.uname</key>
                    <delay>1d</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>OS version</description>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                        <application>
                            <name>OS overview</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff(0)}&gt;0</expression>
                            <name>Host information was changed on &quot;{HOST.NAME}&quot;</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>System Uptime</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.uptime</key>
                    <delay>15m</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>System uptime</description>
                    <applications>
                        <application>
                            <name>OS</name>
                        </application>
                        <application>
                            <name>OS overview</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{change(0)}&lt;0</expression>
                            <name>&quot;{HOST.NAME}&quot; has just been restarted</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Physical memory cache bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT CacheBytes FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <units>B</units>
                    <description>\Memory\Cache Bytes&#13;
&#13;
Cache Bytes is the sum of the Memory\\System Cache Resident Bytes, Memory\\System Driver Resident Bytes, Memory\\System Code Resident Bytes, and Memory\\Pool Paged Resident Bytes counters. This counter displays the last observed value only; it is not an average.&#13;
&#13;
The Memory performance object consists of counters that describe the behavior of physical and virtual memory on the computer. Physical memory is the amount of random access memory on the computer. Virtual memory consists of the space in physical memory and on disk. Many of the memory counters monitor paging, which is the movement of pages of code and data between disk and physical memory. Excessive paging, a symptom of a memory shortage, can cause delays which interfere with all system processes.</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Physical memory Committed Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT CommittedBytes FROM Win32_PerfRawData_PerfOS_Memory]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>\Memory\% Committed Bytes&#13;
&#13;
Memory Available Megabytes in Use This measures the ratio of Committed Bytes to the Commit Limit—in other words, the amount of virtual memory in use. This indicates insufficient memory if the number is greater than 80 percent. The obvious solution for this is to add more memory.</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Physical memory free</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,select FreePhysicalMemory from Win32_OperatingSystem]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <description>\Memory\Available Bytes&#13;
&#13;
Memory Available Megabytes</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{avg(30m)}&lt;{$PHYSICAL_MEMORY_MIN_FREE}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{avg(30m)}&gt;{$PHYSICAL_MEMORY_MIN_FREE}</recovery_expression>
                            <name>Physical memory free &lt; {$PHYSICAL_MEMORY_MIN_FREE}</name>
                            <priority>INFO</priority>
                            <description>Available Megabytes is different from most other KHIs in the regard that you need to pay attention to two things:&#13;
•	The trending direction is reversed (i.e. higher is better)&#13;
•	Track the minimum and average, not maximum. &#13;
Most likely, the server doesn’t have enough RAM to fulfil demand. To verify, either use Task Manager and look for unaccounted processes or use the Private Bytes (in process counter object) to see identify the culprit.&#13;
Lastly, if you discover SQL Server Express on Front-end Servers is the consumer of this memory verify that Lock Pages in Memory is disabled. When configured, Windows Memory Manager cannot trim SQL Servers Working Set for other processes while that memory is not in used.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Physical memory Free System Page Table Entries</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT FreeSystemPageTableEntries FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>Memory\Free System Page Table Entries&#13;
&#13;
This indicates the number of page table entries not currently in use by the system. If the number is less than 5,000, there may well be a memory leak.</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;5000</expression>
                            <name>Physical memory Page Table Entries &lt; 5000</name>
                            <priority>INFO</priority>
                            <description>If the number is less than 5,000, there may well be a memory leak.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Physical memory Page Faults Per sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT PageFaultsPersec FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <description>Memory\ Page Faults Per sec &#13;
&#13;
Page Faults/sec is the average number of pages faulted per second. It is measured in number of pages faulted per second because only one page is faulted in each fault operation, hence this is also equal to the number of page fault operations. This counter includes both hard faults (those that require disk access) and soft faults (where the faulted page is found elsewhere in physical memory.) Most processors can handle large numbers of soft faults without significant consequence. However, hard faults, which require disk access, can cause significant delays.&#13;
&#13;
The Memory performance object consists of counters that describe the behavior of physical and virtual memory on the computer. Physical memory is the amount of random access memory on the computer. Virtual memory consists of the space in physical memory and on disk. Many of the memory counters monitor paging, which is the movement of pages of code and data between disk and physical memory. Excessive paging, a symptom of a memory shortage, can cause delays which interfere with all system processes.</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Physical memory Page per sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2, select PagesPersec FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>Memory\Pages per Second &#13;
&#13;
This measures the rate at which pages are read from or written to disk to resolve hard page faults. If the value is greater than 1,000, as a result of excessive paging, there may be a memory leak.</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(30m)}&gt;1000</expression>
                            <name>Physical memory pages per sec &gt; 1000</name>
                            <priority>INFO</priority>
                            <description>If the value is greater than 1,000, as a result of excessive paging, there may be a memory leak.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Processor Interrupt Time %</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT PercentInterruptTime FROM Win32_PerfFormattedData_PerfOS_Processor]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>Processor\% Interrupt Time&#13;
&#13;
This measures the time the processor spends receiving and servicing hardware interruptions during specific sample intervals. This counter indicates a possible hardware issue if the value is greater than 15 percent.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(1h)}&gt;15</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{avg(1h)}&lt;10</recovery_expression>
                            <name>Processor Interrupt Time &gt; 15%</name>
                            <priority>WARNING</priority>
                            <description>possible hardware issue</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Processor Privileged Time %</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2, SELECT PercentPrivilegedTime FROM Win32_PerfFormattedData_PerfOS_Processor]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>Processor\% Privileged Time&#13;
&#13;
This is the percentage of elapsed time that the process threads spent executing code in privileged mode. When a Windows system service in called, the service will often run in privileged mode to gain access to system-private data. Such data is protected from access by threads executing in user mode. Calls to the system can be explicit or implicit, such as page faults or interrupts. Unlike some early operating systems, Windows uses process boundaries for subsystem protection in addition to the traditional protection of user and privileged modes. Some work done by Windows on behalf of the application might appear in other subsystem processes in addition to the privileged time in the process.&#13;
&#13;
The Processor performance object consists of counters that measure aspects of processor activity The processor is the part of the computer that performs arithmetic and logical computations, initiates operations on peripherals, and runs the threads of processes. A computer can have multiple processors. The processor object represents each processor as an instance of the object.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Processor load %</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,select PercentProcessorTime from Win32_PerfformattedData_PerfOS_Processor where Name='_Total']</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>\Processor Information(_Total)\% Processor Time</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(1h)}&gt;{$CPU_MAX_LOAD}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{avg(1h)}&lt;{$CPU_MAX_LOAD}</recovery_expression>
                            <name>Processor load &gt; {$CPU_MAX_LOAD}%</name>
                            <priority>AVERAGE</priority>
                            <description>If % Processor Time is 80% or higher, the first path to explore is determining if there is a legitimate need to increase CPU capacity of your Lync Servers. Windows Server 2008 introduced new Power Management settings (which are on by default) to help reduce carbon footprint produced from Servers by consuming less electricity by parking CPU cores that are lightly utilized by moving those tasks to other cores. What this means is that high Processor Time values no longer automatically mean the physical CPUs are approaching their hardware limits</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Physical memory Page File % Usage</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2, SELECT PercentUsagePeak FROM Win32_PerfFormattedData_PerfOS_PagingFile]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>The peak usage of the Page File instance in percent. &#13;
&#13;
The Paging File performance object consists of counters that monitor the paging file(s) on the computer. The paging file is a reserved space on disk that backs up committed physical memory on the computer.</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(30m)}&gt;70</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{avg(30m)}&#13;
&lt;60</recovery_expression>
                            <name>Physical memory Page File Usage &gt; 70%</name>
                            <priority>INFO</priority>
                            <description>You could also confirm that it is on the most suitable disk, and if possible split the pagefile over two disks and thus improve access times.  (Note the object here is Page File not Memory)&#13;
&#13;
Because the changes are so gradual, you are better off using this Page File % Usage counter as an alert, rather than a log.  I suggest setting an alert on a limit of over 70.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Processor User Time %</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT PercentUserTime FROM Win32_PerfFormattedData_PerfOS_Processor]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>Processor\% User Time&#13;
&#13;
This measures the percentage of elapsed time the processor spends in user mode. If this value is high, the server is busy with the application. One possible solution here is to optimize the application that is using up the processor resources.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Physical memory Pool Non-paged Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT PoolNonpagedBytes FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <units>B</units>
                    <description>Memory\Pool Non-Paged Bytes &#13;
&#13;
This measures the size, in bytes, of the non-paged pool. This is an area of system memory for objects that cannot be written to disk but instead must remain in physical memory as long as they are allocated. There is a possible memory leak if the value is greater than 175MB (or 100MB with the /3GB switch). A typical Event ID 2019 is recorded in the system event log.</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(30m)}&gt;175M</expression>
                            <name>Physical memory Pool Non-paged &gt; 175 Mb</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>There is a possible memory leak if the value is greater than 175MB (or 100MB with the /3GB switch).</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Physical memory Pool Paged Bytes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,SELECT PoolPagedBytes FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <units>B</units>
                    <description>Memory\Pool Paged Bytes &#13;
&#13;
This measures the size, in bytes, of the paged pool. This is an area of system memory used for objects that can be written to disk when they are not being used. There may be a memory leak if this value is greater than 250MB (or 170MB with the /3GB switch). A typical Event ID 2020 is recorded in the system event log.</description>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Performance</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(30m)}&gt;250M</expression>
                            <name>Physical memory Pool paged &gt; 250 Mb</name>
                            <status>DISABLED</status>
                            <priority>WARNING</priority>
                            <description>This is an area of system memory used for objects that can be written to disk when they are not being used. There may be a memory leak if this value is greater than 250MB (or 170MB with the /3GB switch).</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Processor Queue Length</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2, SELECT ProcessorQueueLength FROM Win32_PerfFormattedData_PerfOS_System]</key>
                    <delay>15s</delay>
                    <history>1w</history>
                    <value_type>FLOAT</value_type>
                    <description>System\Processor Queue Length&#13;
&#13;
This indicates the number of threads in the processor queue. The server doesn't have enough processor power if the value is more than two times the number of CPUs for an extended period of time.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Physical memory total</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>wmi.get[root\cimv2,select TotalPhysicalMemory from Win32_ComputerSystem]</key>
                    <delay>1h</delay>
                    <history>1w</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Hardware overview</name>
                        </application>
                        <application>
                            <name>Physical memory</name>
                        </application>
                    </applications>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Logical Disk discover</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>os.windows.active[discover,ldisk]</key>
                    <delay>1d</delay>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Used Disk &quot;{#LOGICAL_DISK} {#LOGICAL_DISK_VOLUME_NAME}&quot;</name>
                            <type>CALCULATED</type>
                            <key>os.windows.active.ldisk.used.bytes[{#LOGICAL_DISK}]</key>
                            <history>1w</history>
                            <units>B</units>
                            <params>last(&quot;wmi.get[root\cimv2,select Size from win32_logicaldisk where DeviceID='{#LOGICAL_DISK}']&quot;)-last(&quot;wmi.get[root\cimv2,select FreeSpace from win32_logicaldisk where DeviceID='{#LOGICAL_DISK}']&quot;)</params>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Used Disk &quot;{#LOGICAL_DISK} {#LOGICAL_DISK_VOLUME_NAME}&quot; bytes 12h linear forecast shifted</name>
                            <type>CALCULATED</type>
                            <key>os.windows.active.ldisk.used.forecast12hshifted[{#LOGICAL_DISK}]</key>
                            <history>1w</history>
                            <units>B</units>
                            <params>last(&quot;os.windows.active.ldisk.used.forecastmb12h[{#LOGICAL_DISK}]&quot;,#1,12h)</params>
                            <description>Forecast to 12 h</description>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1048576</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Used Disk &quot;{#LOGICAL_DISK} {#LOGICAL_DISK_VOLUME_NAME}&quot; bytes 12h linear forecast</name>
                            <type>CALCULATED</type>
                            <key>os.windows.active.ldisk.used.forecast12h[{#LOGICAL_DISK}]</key>
                            <history>1w</history>
                            <units>B</units>
                            <params>forecast(&quot;os.windows.active.ldisk.used.mbytes[{#LOGICAL_DISK}]&quot;,12h,,12h)</params>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1048576</params>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$LOGICAL_DISK_FREE_SPACE_HIGH} and {last()}&gt;{$LOGICAL_DISK_FREE_SPACE_DISASTER}</expression>
                                    <name>Forecast: Free disk space is less than {$LOGICAL_DISK_FREE_SPACE_HIGH} on volume &quot;{#LOGICAL_DISK}&quot; (Last: {ITEM.LASTVALUE1}) in next 12 hours</name>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$LOGICAL_DISK_FREE_SPACE_INFO} and {last()}&gt;{$LOGICAL_DISK_FREE_SPACE_HIGH}</expression>
                                    <name>Forecast: Free disk space is less than {$LOGICAL_DISK_FREE_SPACE_INFO} on volume &quot;{#LOGICAL_DISK}&quot; (Last: {ITEM.LASTVALUE1}) in next 12 hours</name>
                                    <priority>INFO</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Used Disk &quot;{#LOGICAL_DISK} {#LOGICAL_DISK_VOLUME_NAME}&quot; bytes 12h linear forecast (MB)</name>
                            <type>CALCULATED</type>
                            <key>os.windows.active.ldisk.used.forecastmb12h[{#LOGICAL_DISK}]</key>
                            <history>1w</history>
                            <params>forecast(&quot;os.windows.active.ldisk.used.mbytes[{#LOGICAL_DISK}]&quot;,12h,,12h)</params>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Used Disk &quot;{#LOGICAL_DISK} {#LOGICAL_DISK_VOLUME_NAME}&quot; (MB)</name>
                            <type>CALCULATED</type>
                            <key>os.windows.active.ldisk.used.mbytes[{#LOGICAL_DISK}]</key>
                            <history>1w</history>
                            <params>last(os.windows.active.ldisk.used.bytes[{#LOGICAL_DISK}])/1024/1024</params>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Free disk &quot;{#LOGICAL_DISK} {#LOGICAL_DISK_VOLUME_NAME}&quot;</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select FreeSpace from win32_logicaldisk where DeviceID='{#LOGICAL_DISK}']</key>
                            <history>1w</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                                <application>
                                    <name>Hardware overview</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$LOGICAL_DISK_FREE_SPACE_DISASTER}</expression>
                                    <name>Free disk space is less than {$LOGICAL_DISK_FREE_SPACE_DISASTER} on volume &quot;{#LOGICAL_DISK}&quot; (Last: {ITEM.LASTVALUE1})</name>
                                    <priority>DISASTER</priority>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$LOGICAL_DISK_FREE_SPACE_HIGH} and {last()}&gt;{$LOGICAL_DISK_FREE_SPACE_DISASTER}</expression>
                                    <name>Free disk space is less than {$LOGICAL_DISK_FREE_SPACE_HIGH} on volume &quot;{#LOGICAL_DISK}&quot; (Last: {ITEM.LASTVALUE1})</name>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&lt;{$LOGICAL_DISK_FREE_SPACE_INFO} and {last()}&gt;{$LOGICAL_DISK_FREE_SPACE_HIGH}</expression>
                                    <name>Free disk space is less than {$LOGICAL_DISK_FREE_SPACE_INFO} on volume &quot;{#LOGICAL_DISK}&quot; (Last: {ITEM.LASTVALUE1})</name>
                                    <priority>INFO</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Total Disk &quot;{#LOGICAL_DISK} {#LOGICAL_DISK_VOLUME_NAME}&quot;</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select Size from win32_logicaldisk where DeviceID='{#LOGICAL_DISK}']</key>
                            <history>1w</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Disk &quot;{#LOGICAL_DISK}&quot; usage</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select Size from win32_logicaldisk where DeviceID='{#LOGICAL_DISK}']</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>FILLED_REGION</drawtype>
                                    <color>F63100</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>os.windows.active.ldisk.used.bytes[{#LOGICAL_DISK}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Disk &quot;{#LOGICAL_DISK}&quot; usage (12h forecast)</name>
                            <graph_items>
                                <graph_item>
                                    <color>CC0000</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>os.windows.active.ldisk.used.bytes[{#LOGICAL_DISK}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>00CC00</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>os.windows.active.ldisk.used.forecast12h[{#LOGICAL_DISK}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>3333FF</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>os.windows.active.ldisk.used.forecast12hshifted[{#LOGICAL_DISK}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Physical Disk discover</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>os.windows.active[discover,pdisk]</key>
                    <delay>1d</delay>
                    <lifetime>7d</lifetime>
                    <description>Get physical disks</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; Avg. Disk Read/sec</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select AvgDisksecPerRead from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <value_type>FLOAT</value_type>
                            <description>\PhysicalDisk({#PHYSICAL_DISK})\Avg. Disk sec/Read&#13;
&#13;
Displays the average time the disk transfers took to complete, in seconds. Although the scale is seconds, the counter has millisecond precision, meaning a value of 0.004 indicates the average time for disk transfers to complete was 4 milliseconds. &#13;
This is the counter in Perfmon used to measure IO latency. &#13;
I wrote a blog specifically about measuring latency with Perfmon. For details got to “Measuring Disk Latency with Windows Performance Monitor”. &#13;
&#13;
http://blogs.technet.com/b/askcore/archive/2012/02/07/measuring-disk-latency-with-windows-performance-monitor-perfmon.aspx</description>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg(30m)}&gt;{$PHYSICAL_DISK_AVG_READ}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{avg(30m)}&lt;{$PHYSICAL_DISK_AVG_READ}</recovery_expression>
                                    <name>PhysicalDisk &quot;{#PHYSICAL_DISK}&quot; Avg. Disk sec/Read &gt; {$PHYSICAL_DISK_AVG_READ}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; Avg. Disk Write/sec</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select AvgDisksecPerWrite from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <value_type>FLOAT</value_type>
                            <description>\PhysicalDisk({#PHYSICAL_DISK})\Avg. Disk sec/Write&#13;
&#13;
Displays the average time the disk transfers took to complete, in seconds. Although the scale is seconds, the counter has millisecond precision, meaning a value of 0.004 indicates the average time for disk transfers to complete was 4 milliseconds. &#13;
This is the counter in Perfmon used to measure IO latency.</description>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg(30m)}&gt;{$PHYSICAL_DISK_AVG_WRITE}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{avg(30m)}&lt;{$PHYSICAL_DISK_AVG_WRITE}</recovery_expression>
                                    <name>PhysicalDisk &quot;{#PHYSICAL_DISK}&quot; Avg. Disk sec/Write &gt; {$PHYSICAL_DISK_AVG_WRITE}</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; Disk Read Bytes/sec</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select DiskReadBytesPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <description>perf_counter[&quot;\PhysicalDisk({#PHYSICAL_DISK})\Disk Read Bytes/sec&quot;]&#13;
&#13;
Perfmon captures the total number of bytes sent to the disk (write) and retrieved from the disk (read) over a period of one second. If the Perfmon capture interval is set for anything greater than one second, the average of the values captured is presented. &#13;
The Disk Read Bytes/sec and the Disk Write Bytes/sec counters break down the results displaying only read bytes or only write bytes, respectively. &#13;
&#13;
The average speed of data exchange with the disk, or the speed of reading / writing. Shows the total number of bytes sent to disk (write) and disk (read) for one second, thereby allowing you to estimate the throughput of the disk system. It is built from the values Disk Read Bytes / sec (read speed) and Disk Write Bytes / sec (write speed). Limit values strongly depend on the type of disk: for example, for a single hard drive, the maximum read / write speed is 160-250Mb / s, for a single SSD, about 550-600Mb / s.</description>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; Disk Transfers/sec iops</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select DiskTransfersPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <value_type>FLOAT</value_type>
                            <units>ops/s</units>
                            <description>perf_counter[&quot;\PhysicalDisk({#PHYSICAL_DISK})\Disk Transfers/sec&quot;]&#13;
&#13;
Disk Transfers/sec is the rate of read and write operations on the disk.&#13;
&#13;
The Physical Disk performance object consists of counters that monitor hard or fixed disk drive on a computer. Disks are used to store file, program, and paging data and are read to retrieve these items, and written to record changes to them. The values of physical disk counters are sums of the values of the logical disks (or partitions) into which they are divided.&#13;
&#13;
The main indicator of the intensity of requests to the disk. Shows the total number of I / O operations processed (completed) by the disk for 1 second (Input / Output Operations Per Second, IOPS). This counter allows you to roughly estimate how much the load on the disks is close to the limit. For disks running in normal mode, you can focus on the following values: 80-160 IOPS for a single SATA or SAS hard drive, 1800-5000 IOPS for a single SSD drive. To clarify, you can use Disk Reads / sec counters (the number of read requests processed per second) and Disk Writes / sec (the number of write requests processed per second).</description>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; Disk Write Bytes/sec</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select DiskWriteBytesPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <value_type>FLOAT</value_type>
                            <units>Bps</units>
                            <description>perf_counter[&quot;\PhysicalDisk({#PHYSICAL_DISK})\Disk Write Bytes/sec&quot;]&#13;
&#13;
Perfmon captures the total number of bytes sent to the disk (write) and retrieved from the disk (read) over a period of one second. If the Perfmon capture interval is set for anything greater than one second, the average of the values captured is presented. &#13;
The Disk Read Bytes/sec and the Disk Write Bytes/sec counters break down the results displaying only read bytes or only write bytes, respectively. &#13;
&#13;
The average speed of data exchange with the disk, or the speed of reading / writing. Shows the total number of bytes sent to disk (write) and disk (read) for one second, thereby allowing you to estimate the throughput of the disk system. It is built from the values Disk Read Bytes / sec (read speed) and Disk Write Bytes / sec (write speed). Limit values strongly depend on the type of disk: for example, for a single hard drive, the maximum read / write speed is 160-250Mb / s, for a single SSD, about 550-600Mb / s.</description>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; Disk bytes/second</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>EE0000</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select DiskReadBytesPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>0000EE</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select DiskWriteBytesPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; ops/second</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select DiskTransfersPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; overview</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>FILLED_REGION</drawtype>
                                    <color>EE0000</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select DiskReadBytesPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>FILLED_REGION</drawtype>
                                    <color>0000EE</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select DiskWriteBytesPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>33FF33</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select DiskTransfersPersec from Win32_PerfFormattedData_PerfDisk_PhysicalDisk where Name='{#PHYSICAL_DISK}']</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Network Interface discover</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>os.windows.active[discover,pnetwork]</key>
                    <delay>1d</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>Get network interfaces</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; % Utilization</name>
                            <type>CALCULATED</type>
                            <key>os.windows.active.networkinterface.utilization.percent[{#PHYSICAL_NETWORK_INTERFACEINDEX}]</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <params>( (last(&quot;wmi.get[root\cimv2,select BytesTotalPersec from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']&quot;) *8) /&#13;
last(&quot;wmi.get[root\cimv2,select CurrentBandwidth from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']&quot;))*100</params>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg(6h)}&gt;{$NETWORK_MAX_UTILIZE}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{avg(6h)}&lt;{$NETWORK_MAX_UTILIZE}</recovery_expression>
                                    <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; utilize &gt; {$NETWORK_MAX_UTILIZE}%</name>
                                    <priority>WARNING</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; Incoming Bytes/sec</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select BytesReceivedPersec from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <units>Bps</units>
                            <description>\Network Interface({#PNETWORK})\Bytes Received/sec</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; Outbound Bytes/sec</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select BytesSentPersec from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <units>Bps</units>
                            <description>\Network Interface({#PNETWORK})\Bytes Sent/sec</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; Total Bytes/sec</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select BytesTotalPersec from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']</key>
                            <delay>15s</delay>
                            <history>1w</history>
                            <units>Bps</units>
                            <description>last(&quot;perf_counter[\&quot;\Network Interface({#PNETWORK})\Bytes Received/sec\&quot;]&quot;)*(-1)+&#13;
last(&quot;perf_counter[\&quot;\Network Interface({#PNETWORK})\Bytes Sent/sec\&quot;]&quot;)</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; LinkSpeed</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select CurrentBandwidth from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']</key>
                            <delay>5m</delay>
                            <history>1w</history>
                            <units>B</units>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; MAC Address</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select MACAddress from win32_networkadapter where InterfaceIndex='{#PHYSICAL_NETWORK_INTERFACEINDEX}']</key>
                            <delay>5m</delay>
                            <history>1w</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff(0)}&gt;0</expression>
                                    <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; MAC Address changed</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; LinkStatus</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select NetConnectionStatus from win32_networkadapter where InterfaceIndex='{#PHYSICAL_NETWORK_INTERFACEINDEX}']</key>
                            <history>1w</history>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Microsoft Network Link Status</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff(0)}&gt;0</expression>
                                    <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; Link Status changed</name>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; Output Queue Length</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select OutputQueueLength from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']</key>
                            <history>1w</history>
                            <description>\Network Interface({#PNETWORK})\Output Queue Length&#13;
&#13;
“Output Queue Length is the length of the output packet queue (in packets). If this is longer than two, there are delays and the bottleneck should be found and eliminated, if possible. Since the requests are queued by the Network Driver Interface Specification (NDIS) in this implementation, this will always be 0.”&#13;
&#13;
https://blogs.technet.microsoft.com/yongrhee/2010/07/06/network-interface-output-queue-length-values-extremely-high/</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last(#5)}&gt;{$NETWORK_OUTPUT_QUEUE_LENGHT}</expression>
                                    <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; Output Queue Length &gt; {$NETWORK_OUTPUT_QUEUE_LENGHT}</name>
                                    <priority>WARNING</priority>
                                    <description>Each Network Interface has an associated output queue. Output Queue Length measures how many outbound network packets are queued. Output Queue Length of 2 or more indicates serious Network Interface bottlenecks. &#13;
When reviewing Output Queue Length, it is important to review the active Network Interface utilized.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; Packets Outbound Discarded</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>wmi.get[root\cimv2,select PacketsOutboundDiscarded from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']</key>
                            <history>1w</history>
                            <description>\Network Interface({#PNETWORK})\Packets Outbound Discarded&#13;
&#13;
Shows the number of outbound packets to be discarded even though no errors had been detected to prevent transmission. One possible reason for discarding the a packet could be to free up buffer space.&#13;
&#13;
https://msdn.microsoft.com/en-us/library/ms803962.aspx</description>
                            <applications>
                                <application>
                                    <name>Network</name>
                                </application>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last(#1)}&gt;{$NETWORK_OUTPUT_DISCARDED}</expression>
                                    <name>Network Interface &quot;{#PHYSICAL_NETWORK_NAME}&quot; Packets Outbound Discarded &gt;{$NETWORK_OUTPUT_DISCARDED}</name>
                                    <priority>INFO</priority>
                                    <description>A healthy Server deployment should not be consistently discarding network packets on a managed network. The threshold means that packets are being discarded and the server administrator should be aware and understand why that is occurring. If the Network Interface is too busy, requests may not be getting processed quickly enough and become discarded. &#13;
It is important to note that these Performance Counters are total based. To get the value for review, you’ll need to subtract the maximum of the last sample from to the maximum of the first sample (we’ve done this for you in the Analysis and Definitions Workbook), leaving you with the delta of how many packets have been discarded during your data collection. If you see that the value is not zero, but is the same for average and max, it hasn’t moved in the dataset. Therefore, it could be contributed to a change in the environment that was expected (e.g. switch firmware ugrade) and be a non-issue.&#13;
Depending on the Network Interface manufacture, the receive and transmit buffers may be configurable. If they are, set them to an automatic setting. Should that not be an option, consider doubling the current value and re-evaluate.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Network traffic on &quot;{#PHYSICAL_NETWORK_NAME}&quot;</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>0000EE</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select BytesSentPersec from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>EE0000</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>wmi.get[root\cimv2,select BytesReceivedPersec from Win32_PerfFormattedData_Tcpip_NetworkInterface where Name='{#PHYSICAL_NETWORK_NAME_PERF}']</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>FFFF66</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>os.windows.active.networkinterface.utilization.percent[{#PHYSICAL_NETWORK_INTERFACEINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Network utilization % &quot;{#PHYSICAL_NETWORK_NAME}&quot;</name>
                            <ymax_type_1>FIXED</ymax_type_1>
                            <graph_items>
                                <graph_item>
                                    <drawtype>FILLED_REGION</drawtype>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template OS Windows Active</host>
                                        <key>os.windows.active.networkinterface.utilization.percent[{#PHYSICAL_NETWORK_INTERFACEINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Windows service discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>service.discovery</key>
                    <delay>1d</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SERVICE.NAME}</macro>
                                <value>@Windows service names for discovery</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SERVICE.STARTUPNAME}</macro>
                                <value>@Windows service startup states for discovery</value>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>1w</lifetime>
                    <description>Discovery of Windows services of different types as defined in global regular expressions &quot;Windows service names for discovery&quot; and &quot;Windows service startup states for discovery&quot;.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>State of service &quot;{#SERVICE.NAME}&quot; ({#SERVICE.DISPLAYNAME})</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>service.info[{#SERVICE.NAME},state]</key>
                            <delay>5m</delay>
                            <history>1w</history>
                            <applications>
                                <application>
                                    <name>Services</name>
                                </application>
                            </applications>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Startup {#SERVICE.STARTUPNAME} services</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>Windows service state</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{min(#3)}&lt;&gt;0</expression>
                                    <name>Service &quot;{#SERVICE.NAME}&quot; ({#SERVICE.DISPLAYNAME}) is not running (startup type {#SERVICE.STARTUPNAME})</name>
                                    <status>DISABLED</status>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$CPU_MAX_LOAD}</macro>
                    <value>85</value>
                </macro>
                <macro>
                    <macro>{$LOGICAL_DISK_FREE_SPACE_DISASTER}</macro>
                    <value>1G</value>
                </macro>
                <macro>
                    <macro>{$LOGICAL_DISK_FREE_SPACE_HIGH}</macro>
                    <value>10G</value>
                </macro>
                <macro>
                    <macro>{$LOGICAL_DISK_FREE_SPACE_INFO}</macro>
                    <value>25G</value>
                </macro>
                <macro>
                    <macro>{$NETWORK_MAX_UTILIZE}</macro>
                    <value>80</value>
                </macro>
                <macro>
                    <macro>{$NETWORK_OUTPUT_DISCARDED}</macro>
                    <value>100</value>
                </macro>
                <macro>
                    <macro>{$NETWORK_OUTPUT_QUEUE_LENGHT}</macro>
                    <value>2</value>
                </macro>
                <macro>
                    <macro>{$PHYSICAL_DISK_AVG_READ}</macro>
                    <value>0.25</value>
                </macro>
                <macro>
                    <macro>{$PHYSICAL_DISK_AVG_WRITE}</macro>
                    <value>0.25</value>
                </macro>
                <macro>
                    <macro>{$PHYSICAL_MEMORY_MIN_FREE}</macro>
                    <value>1Gb</value>
                </macro>
                <macro>
                    <macro>{$WINDOWS_UPDATE_LAST_INSTALL_INFO}</macro>
                    <value>90d</value>
                </macro>
                <macro>
                    <macro>{$WINDOWS_UPDATE_LAST_INSTALL_WARN}</macro>
                    <value>180d</value>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>System performance detailed</name>
                    <hsize>2</hsize>
                    <vsize>5</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>CPU</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>400</width>
                            <height>100</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Memory</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>400</width>
                            <height>100</height>
                            <x>1</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Network traffic on &quot;{#PHYSICAL_NETWORK_NAME}&quot;</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>400</width>
                            <height>100</height>
                            <x>0</x>
                            <y>1</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; ops/second</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>250</width>
                            <height>100</height>
                            <x>0</x>
                            <y>2</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>5</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; Disk bytes/second</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>250</width>
                            <height>100</height>
                            <x>0</x>
                            <y>3</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>5</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; overview</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>4</y>
                            <colspan>2</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
                <screen>
                    <name>System performance overview</name>
                    <hsize>2</hsize>
                    <vsize>2</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>CPU</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>400</width>
                            <height>100</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Memory</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>400</width>
                            <height>100</height>
                            <x>1</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Physical Disk &quot;{#PHYSICAL_DISK}&quot; overview</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Network traffic on &quot;{#PHYSICAL_NETWORK_NAME}&quot;</name>
                                <host>Template OS Windows Active</host>
                            </resource>
                            <width>400</width>
                            <height>100</height>
                            <x>1</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{Template OS Windows Active:wmi.get[root\cimv2,SELECT CommittedBytes FROM Win32_PerfRawData_PerfOS_Memory].avg(10m)} &gt;1.5 * {Template OS Windows Active:wmi.get[root\cimv2,select TotalPhysicalMemory from Win32_ComputerSystem].last()}</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{Template OS Windows Active:wmi.get[root\cimv2,SELECT CommittedBytes FROM Win32_PerfRawData_PerfOS_Memory].avg(10m)} &lt; {Template OS Windows Active:wmi.get[root\cimv2,select TotalPhysicalMemory from Win32_ComputerSystem].last()}</recovery_expression>
            <name>Physical memory commited bytes over than total memory</name>
            <priority>INFO</priority>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <name>CPU</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>00EE00</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2,select PercentProcessorTime from Win32_PerfformattedData_PerfOS_Processor where Name='_Total']</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>F63100</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2,SELECT PercentInterruptTime FROM Win32_PerfFormattedData_PerfOS_Processor]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>0000EE</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2,SELECT PercentUserTime FROM Win32_PerfFormattedData_PerfOS_Processor]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>A54F10</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2, SELECT PercentPrivilegedTime FROM Win32_PerfFormattedData_PerfOS_Processor]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory</name>
            <type>STACKED</type>
            <ymax_type_1>ITEM</ymax_type_1>
            <ymax_item_1>
                <host>Template OS Windows Active</host>
                <key>wmi.get[root\cimv2,select TotalPhysicalMemory from Win32_ComputerSystem]</key>
            </ymax_item_1>
            <graph_items>
                <graph_item>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>FF3333</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2,SELECT CommittedBytes FROM Win32_PerfRawData_PerfOS_Memory]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>3333FF</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2,SELECT PoolNonpagedBytes FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>FFFF33</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2,SELECT PoolPagedBytes FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>33FF33</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2,select FreePhysicalMemory from Win32_OperatingSystem]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>FC6EA3</color>
                    <item>
                        <host>Template OS Windows Active</host>
                        <key>wmi.get[root\cimv2,SELECT CacheBytes FROM Win32_PerfFormattedData_PerfOS_Memory]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
    <value_maps>
        <value_map>
            <name>Microsoft Network Link Status</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Disconnected</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Connecting</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Connected</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Disconnecting</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Hardware not present</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Hardware disabled</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>Hardware malfunction</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>Media disconnected</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>Authenticating</newvalue>
                </mapping>
                <mapping>
                    <value>9</value>
                    <newvalue>Authentication succeeded</newvalue>
                </mapping>
                <mapping>
                    <value>10</value>
                    <newvalue>Authentication failed</newvalue>
                </mapping>
                <mapping>
                    <value>11</value>
                    <newvalue>Invalid Address</newvalue>
                </mapping>
                <mapping>
                    <value>12</value>
                    <newvalue>Credentials Required</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Microsoft Windows Pending Reboot</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>No</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Need reboot</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Windows service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Running</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Paused</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Start pending</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Pause pending</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Continue pending</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Stop pending</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>Stopped</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>Unknown</newvalue>
                </mapping>
                <mapping>
                    <value>255</value>
                    <newvalue>No such service</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
